;;;----------------------------------------------------------------------------
;;; Copyright (c) 2025-present Detlef Stern
;;;
;;; This file is part of sx.
;;;
;;; sx is licensed under the latest version of the EUPL (European Union
;;; Public License). Please see file LICENSE.txt for your rights and
;;; obligations under this license.
;;;
;;; SPDX-License-Identifier: EUPL-1.2
;;; SPDX-FileCopyrightText: 2025-present Detlef Stern
;;;----------------------------------------------------------------------------

;; Indirekt recursive definition of even/odd
(defvar odd? ()) ; define symbol odd? to make lookup in even? faster, because it is known.
(defun even? (n) (if (= n 0) 1 (odd? (- n 1))))
(defun odd? (n) (if (= n 0) () (even? (- n 1))))

;; Naive implementation of fac
(defun fac (n) (if (= n 0) 1 (* n (fac (- n 1)))))

;; Accumulator based implementation of fac
(defun faa (n acc) (if (= n 0) acc (faa (- n 1) (* acc n))))

;; Naive fibonacci
(defun fib (n) (if (<= n 1) 1 (+ (fib (- n 1)) (fib (- n 2)))))

;; Takeuchi benchmark
(defun tak (x y z)
  (if (not (< y x))
      z
      (tak (tak (- x 1) y z)
           (tak (- y 1) z x)
           (tak (- z 1) x y))))
